# Story 5.5: 검색 결과 기본 하이라이팅

## Status
Draft

## Story
**As a** 사용자,
**I want** 검색 결과에서 검색어가 하이라이트되어 표시되는 기능,
**so that** 검색어와 일치하는 부분을 쉽게 식별할 수 있다

## Acceptance Criteria
1. 검색 결과의 제목과 내용에서 검색어가 하이라이트되어 표시된다
2. 대소문자 구분 없이 검색어가 하이라이트된다
3. 부분 일치하는 검색어도 하이라이트된다
4. 하이라이트된 텍스트는 시각적으로 구분되도록 스타일링된다
5. 검색어가 여러 번 나타나는 경우 모두 하이라이트된다
6. 하이라이트 기능은 성능에 영향을 주지 않는다

## Tasks / Subtasks
- [ ] Task 1: 하이라이팅 유틸리티 함수 구현 (AC: 1, 2, 3, 5)
  - [ ] Subtask 1.1: 텍스트 하이라이팅 함수 생성
  - [ ] Subtask 1.2: 대소문자 구분 없는 매칭 로직 구현
  - [ ] Subtask 1.3: 부분 일치 하이라이팅 로직 구현
  - [ ] Subtask 1.4: 다중 매칭 하이라이팅 처리
- [ ] Task 2: 하이라이팅 컴포넌트 구현 (AC: 4, 6)
  - [ ] Subtask 2.1: 하이라이팅된 텍스트 렌더링 컴포넌트 생성
  - [ ] Subtask 2.2: 하이라이트 스타일링 적용
  - [ ] Subtask 2.3: 성능 최적화 (메모이제이션) 적용
  - [ ] Subtask 2.4: XSS 보안 처리 (HTML 이스케이핑)
- [ ] Task 3: 검색 결과 통합 (AC: 1, 4)
  - [ ] Subtask 3.1: 노트 카드 컴포넌트에 하이라이팅 적용
  - [ ] Subtask 3.2: 검색 결과 미리보기에 하이라이팅 적용
  - [ ] Subtask 3.3: 하이라이팅 상태 관리
- [ ] Task 4: 테스트 구현
  - [ ] Subtask 4.1: 하이라이팅 유틸리티 함수 테스트
  - [ ] Subtask 4.2: 하이라이팅 컴포넌트 테스트
  - [ ] Subtask 4.3: 성능 테스트

## Dev Notes

### Previous Story Insights
- Story 5.1, 5.2에서 검색 기능이 구현되어 있어 검색어 정보 활용 가능
- 기존 노트 카드 컴포넌트 구조를 참고하여 하이라이팅 기능 통합

### Data Models
- **검색 결과**: 검색어와 매칭된 노트 데이터
- **하이라이팅 상태**: searchQuery: string, highlightedText: string
- **노트 데이터**: title, content 필드에 하이라이팅 적용

### API Specifications
- **하이라이팅 로직**: 클라이언트 사이드에서 처리 (성능 고려)
- **검색어 전달**: 기존 검색 API에서 검색어를 결과와 함께 반환
- **보안**: HTML 이스케이핑으로 XSS 공격 방지

### Component Specifications
- **하이라이팅 컴포넌트**: React 컴포넌트로 텍스트 렌더링
- **스타일링**: Tailwind CSS의 highlight 클래스 사용 [Source: architecture.md#1]
- **성능**: React.memo와 useMemo를 활용한 최적화
- **접근성**: 하이라이트된 텍스트에 적절한 ARIA 속성 적용

### File Locations
- **하이라이팅 유틸리티**: `lib/utils/highlight.ts` 생성
- **하이라이팅 컴포넌트**: `components/ui/highlighted-text.tsx` 생성
- **노트 카드 수정**: `components/notes/note-card.tsx` 수정
- **테스트**: `__tests__/lib/utils/highlight.test.ts` 생성

### Testing Requirements
- **단위 테스트**: Vitest 프레임워크 사용
- **테스트 범위**: 하이라이팅 로직, 컴포넌트 렌더링, 성능
- **통합 테스트**: 검색 결과와 하이라이팅 통합 동작 검증

### Technical Constraints
- **성능**: 대량의 텍스트 처리 시 성능 저하 방지
- **보안**: XSS 공격 방지를 위한 HTML 이스케이핑 필수
- **접근성**: 스크린 리더 사용자를 위한 적절한 마크업
- **브라우저 호환성**: 모든 주요 브라우저에서 동일한 하이라이팅 표시

## Testing

### Testing Standards
- **프레임워크**: Vitest 사용
- **테스트 파일 위치**: `__tests__/` 디렉토리 구조 준수
- **테스트 패턴**: Given-When-Then 구조

### Specific Testing Requirements
- 대소문자 구분 없는 하이라이팅 테스트
- 부분 일치 하이라이팅 테스트
- 다중 매칭 하이라이팅 테스트
- 특수문자 포함 검색어 하이라이팅 테스트
- XSS 보안 테스트 (악성 스크립트 입력)
- 성능 테스트 (긴 텍스트 처리)
- 접근성 테스트 (스크린 리더 호환성)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-12-19 | 1.0 | 초기 스토리 생성 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### Debug Log References
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### Completion Notes List
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

### File List
*이 섹션은 개발 에이전트가 구현 중에 채워집니다*

## QA Results
*이 섹션은 QA 에이전트가 검토 후 채워집니다*
