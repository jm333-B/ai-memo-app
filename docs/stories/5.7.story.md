# Story 5.7: 빈 검색 결과 처리

## Status
Done

## Story
**As a** 사용자,
**I want** 검색 결과가 없을 때 적절한 안내와 대안을 제공받는 기능,
**so that** 검색 실패 시에도 유용한 정보를 얻을 수 있다

## Acceptance Criteria
1. 검색 결과가 없을 때 "검색 결과가 없습니다" 메시지가 표시된다
2. 빈 검색 결과 화면에 검색어가 표시되어 사용자가 확인할 수 있다
3. 검색어 수정을 위한 제안이 제공된다 (오타 수정, 유사어 제안)
4. 관련 태그나 인기 검색어를 추천한다
5. 검색 필터를 초기화할 수 있는 옵션이 제공된다
6. 빈 검색 결과 화면이 시각적으로 매력적이고 도움이 된다

## Tasks / Subtasks
- [x] Task 1: 빈 검색 결과 컴포넌트 구현 (AC: 1, 2, 6)
  - [x] Subtask 1.1: EmptySearchResults 컴포넌트 생성
  - [x] Subtask 1.2: 검색어 표시 및 스타일링 구현
  - [x] Subtask 1.3: 빈 상태 일러스트레이션 또는 아이콘 추가
  - [x] Subtask 1.4: 반응형 디자인 적용
- [x] Task 2: 검색어 수정 제안 기능 (AC: 3)
  - [x] Subtask 2.1: 오타 수정 제안 로직 구현
  - [x] Subtask 2.2: 유사어 제안 로직 구현
  - [x] Subtask 2.3: 제안된 검색어 클릭 시 재검색 기능
  - [x] Subtask 2.4: 제안 UI 컴포넌트 구현
- [x] Task 3: 관련 콘텐츠 추천 (AC: 4, 5)
  - [x] Subtask 3.1: 인기 태그 조회 API 구현
  - [x] Subtask 3.2: 최근 검색어 조회 기능 구현
  - [x] Subtask 3.3: 추천 콘텐츠 표시 컴포넌트 구현
  - [x] Subtask 3.4: 필터 초기화 기능 구현
- [x] Task 4: 테스트 구현
  - [x] Subtask 4.1: 빈 검색 결과 컴포넌트 테스트
  - [x] Subtask 4.2: 검색어 수정 제안 테스트
  - [x] Subtask 4.3: 추천 콘텐츠 테스트

## Dev Notes

### Previous Story Insights
- Story 5.1~5.6에서 검색 및 필터링 기능이 구현되어 있어 빈 결과 상태 처리 필요
- 기존 empty-state 컴포넌트가 있다면 참고하여 일관된 디자인 적용

### Data Models
- **빈 검색 결과 상태**: searchQuery: string, hasResults: boolean, suggestions: string[]
- **검색어 제안**: originalQuery: string, suggestions: string[], confidence: number
- **추천 콘텐츠**: popularTags: string[], recentSearches: string[]
- **사용자 스코프**: 모든 추천은 user_id 기반 [Source: architecture.md#3]

### API Specifications
- **인기 태그 API**: `getPopularTags(limit: number = 5)` - 사용자별 인기 태그 조회
- **최근 검색어 API**: `getRecentSearches(limit: number = 5)` - 사용자별 최근 검색어 조회
- **검색어 제안 API**: `getSearchSuggestions(query: string)` - 오타 수정 및 유사어 제안
- **권한 제어**: Supabase Auth를 통한 사용자 인증 확인 [Source: architecture.md#3]

### Component Specifications
- **빈 검색 결과**: shadcn/ui EmptyState 컴포넌트 활용 [Source: architecture.md#1]
- **검색어 제안**: shadcn/ui Button 컴포넌트로 제안 표시
- **추천 태그**: shadcn/ui Badge 컴포넌트로 태그 표시
- **스타일링**: Tailwind CSS 사용 [Source: architecture.md#1]

### File Locations
- **빈 검색 결과 컴포넌트**: `components/notes/empty-search-results.tsx` 생성
- **검색어 제안 컴포넌트**: `components/notes/search-suggestions.tsx` 수정
- **추천 콘텐츠 컴포넌트**: `components/notes/recommended-content.tsx` 생성
- **서버 액션**: `app/actions/notes.ts`에 추천 API 추가
- **테스트**: `__tests__/components/notes/empty-search-results.test.tsx` 생성

### Testing Requirements
- **단위 테스트**: Vitest 프레임워크 사용
- **테스트 범위**: 빈 검색 결과 컴포넌트, 검색어 제안, 추천 콘텐츠
- **통합 테스트**: 빈 검색 결과와 검색 재시도 통합 동작 검증

### Technical Constraints
- **사용자 경험**: 빈 결과 화면이 부정적이지 않도록 긍정적인 메시지 제공
- **성능**: 추천 콘텐츠 로딩 시 지연 시간 최소화
- **접근성**: 스크린 리더 사용자를 위한 적절한 안내 메시지
- **일관성**: 기존 empty-state 컴포넌트와 일관된 디자인

## Testing

### Testing Standards
- **프레임워크**: Vitest 사용
- **테스트 파일 위치**: `__tests__/` 디렉토리 구조 준수
- **테스트 패턴**: Given-When-Then 구조

### Specific Testing Requirements
- 빈 검색 결과 화면 렌더링 테스트
- 검색어 표시 정확성 테스트
- 검색어 수정 제안 기능 테스트
- 유사어 제안 정확성 테스트
- 인기 태그 추천 테스트
- 최근 검색어 표시 테스트
- 필터 초기화 기능 테스트
- 검색어 제안 클릭 시 재검색 테스트
- 반응형 디자인 테스트

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-12-19 | 1.0 | 초기 스토리 생성 | Bob (SM) |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4

### Debug Log References
- 빈 검색 결과 처리 API 구현 완료
- 검색어 수정 제안 및 유사도 계산 로직 구현 완료
- 인기 태그 추천 기능 구현 완료
- 빈 검색 결과 UI 컴포넌트 구현 완료
- 통합 검색 컴포넌트에 빈 결과 처리 통합 완료
- 포괄적인 테스트 커버리지 구현 완료

### Completion Notes List
- `getPopularTags` 서버 액션 구현: 사용자별 인기 태그 조회 및 정렬
- `getSearchQuerySuggestions` 서버 액션 구현: Levenshtein 거리 기반 유사어 제안
- `getRecentSearches` 서버 액션 구현: 최근 검색어 조회 (로컬 스토리지 기반)
- `EmptySearchResults` 컴포넌트 구현: 검색어 표시, 제안, 추천 콘텐츠 제공
- `RecommendedContent` 컴포넌트 구현: 검색어 제안, 인기 태그, 필터 초기화 기능
- 통합 검색 컴포넌트 확장: 빈 검색 결과 처리 통합
- 노트 목록 페이지 업데이트: 빈 검색 결과 상태 처리
- 포괄적인 테스트 구현: API, 컴포넌트 테스트 완료

### File List
- `app/actions/notes.ts` - 빈 검색 결과 처리 서버 액션 추가
- `components/notes/empty-search-results.tsx` - 빈 검색 결과 UI 컴포넌트 생성
- `components/notes/integrated-search.tsx` - 빈 검색 결과 처리 통합
- `app/notes/page.tsx` - 빈 검색 결과 상태 처리 추가
- `__tests__/app/actions/notes.test.ts` - 빈 검색 결과 처리 API 테스트 추가
- `__tests__/components/notes/empty-search-results.test.tsx` - 빈 검색 결과 컴포넌트 테스트 생성

## QA Results
*이 섹션은 QA 에이전트가 검토 후 채워집니다*
